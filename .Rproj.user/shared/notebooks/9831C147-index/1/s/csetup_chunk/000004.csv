"0","knitr::opts_chunk$set("
"0","	echo = FALSE,"
"0","	message = FALSE,"
"0","	warning = FALSE"
"0",")"
"0","library(plotly)"
"0","library(corrplot)"
"0",""
"0","# read the csv file into R"
"0","dat <- read.csv(file='F:/Code projects/BU/555 - analysis and vis/Final/SD-crime.csv', sep = ',')"
"0",""
"0","# Remove columns 2-6, 8-9, 11-12, 15, 16 which are not being used during this analysis"
"0","crime.df <- dat[, c(1,7,10,13,14)]"
"0",""
"0","# create a new column containing just the year"
"0","crime.df$year <- substr(crime.df$month, 5, 6)"
"0",""
"0","# summary stats for data"
"0","full.stats <- data.frame('Measure' = c('Violent Crime', 'Burglary', 'Thefts', "
"0","                                       'Vehicle Theft'),"
"0","                         'Min' = c(summary(crime.df$Total.Violent.Crime)[[1]],"
"0","                                   summary(crime.df$Total.Burglary)[[1]],"
"0","                                   summary(crime.df$Total.Thefts)[[1]],"
"0","                                   summary(crime.df$Motor.Vehicle.Theft)[[1]]),"
"0","                         "
"0","                         'q1' = c(summary(crime.df$Total.Violent.Crime)[[2]],"
"0","                                  summary(crime.df$Total.Burglary)[[2]],"
"0","                                     summary(crime.df$Total.Thefts)[[2]],"
"0","                                  summary(crime.df$Motor.Vehicle.Theft)[[2]]),"
"0","                         "
"0","                         'Median' = c(summary(crime.df$Total.Violent.Crime)[[3]],"
"0","                                      summary(crime.df$Total.Burglary)[[3]],"
"0","                                      summary(crime.df$Total.Thefts)[[3]],"
"0","                                      summary(crime.df$Motor.Vehicle.Theft)[[3]]),"
"0","                         "
"0","                         'Mean' = c(summary(crime.df$Total.Violent.Crime)[[4]],"
"0","                                    summary(crime.df$Total.Burglary)[[4]],"
"0","                                    summary(crime.df$Total.Thefts)[[4]],"
"0","                                    summary(crime.df$Motor.Vehicle.Theft)[[4]]),"
"0","                         "
"0","                         'q3' = c(summary(crime.df$Total.Violent.Crime)[[5]],"
"0","                                  summary(crime.df$Total.Burglary)[[5]],"
"0","                                  summary(crime.df$Total.Thefts)[[5]],"
"0","                                  summary(crime.df$Motor.Vehicle.Theft)[[5]]),"
"0","                         "
"0","                         'Max' = c(summary(crime.df$Total.Violent.Crime)[[6]],"
"0","                                   summary(crime.df$Total.Burglary)[[6]],"
"0","                                   summary(crime.df$Total.Thefts)[[6]],"
"0","                                   summary(crime.df$Motor.Vehicle.Theft)[[6]]))"
"0",""
"0","# reset factors to order by Measure column"
"0","full.stats$Measure <- factor(full.stats$Measure, "
"0","                             levels = c(as.character(full.stats$Measure)))"
"0",""
"0","# Convert factors to character"
"0","full.stats$Measure <- as.character(full.stats$Measure)"
"0",""
"0","# create table for summary stats"
"0","summary.stat.table <- plot_ly("
"0","  type = 'table',"
"0","  height = 180,"
"0","  #width = 700,"
"0","  columnwidth = c(25, 15, 15, 15, 15),"
"0","  header = list("
"0","    values = c('Measure', 'Min', '1st Q', 'Median', 'Mean', '3rd Q', 'Max'),"
"0","    line = list(width = 1, color = 'black'),"
"0","    fill = list(color = c('#1f77b4', '#1f77b4')),"
"0","    font = list(famile = 'Arial', size = 14, color = 'white')"
"0","  ),"
"0","  cells = list("
"0","    values = rbind(full.stats$Measure, full.stats$Min, full.stats$q1, full.stats$Median, "
"0","                   round(full.stats$Mean,1), full.stats$q3, full.stats$Max),"
"0","    align = c('center'),"
"0","    line = list(width = 1, color = 'black')"
"0","  ))"
"0",""
"0","# create a new column to track changes from month to month"
"0","for (row in 1:nrow(crime.df)){"
"0","  crime.df$violent.change[row + 1] <- (crime.df$Total.Violent.Crime[row + 1]"
"0","                             - crime.df$Total.Violent.Crime[row])"
"0","}"
"2","Error in `$<-.data.frame`(`*tmp*`, ""violent.change"", value = c(NA, 85L,  : 
  replacement has 133 rows, data has 132
"
